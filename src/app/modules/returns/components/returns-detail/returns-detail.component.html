<div class="card shadow-sm border-0 rounded-3">
  <div class="card-header bg-light border-bottom">
    <h3 class="mb-0 fw-semibold text-primary">
      {{ id === 'new' ? 'ğŸ§¾ Nueva Solicitud de DevoluciÃ³n' : 'âœï¸ Editar Solicitud de DevoluciÃ³n' }}
    </h3>
  </div>

  <div class="card-body p-4 bg-white">
    <form #returnForm="ngForm" (ngSubmit)="save()" novalidate>

      <!-- Cliente -->
      <div class="mb-4">
        <label class="form-label fw-semibold text-secondary">Cliente (Email / Guest ID)</label>
        <div class="row g-2">
          <div class="col-md-6">
            <input 
              type="text" 
              class="form-control bg-light text-muted border-0" 
              [(ngModel)]="model.userEmail" 
              name="userEmail" 
              placeholder="Email del usuario" 
              readonly 
            />
          </div>
          <div class="col-md-6">
            <input 
              type="text" 
              class="form-control bg-light text-muted border-0" 
              [(ngModel)]="model.guestId" 
              name="guestId" 
              placeholder="Guest ID (si aplica)" 
              readonly 
            />
          </div>
        </div>
        <small class="text-muted fst-italic">Estos campos se rellenan automÃ¡ticamente desde el chat.</small>
      </div>

      <!-- Pedido relacionado -->
      <div class="mb-4">
        <label class="form-label fw-semibold text-secondary">ID del Pedido</label>
        <input 
          type="number" 
          class="form-control bg-light text-muted border-0" 
          [(ngModel)]="model.saleId" 
          name="saleId" 
          placeholder="ID de la venta" 
          readonly 
          required 
        />
        <small class="text-muted fst-italic">Autocompletado con el Ãºltimo pedido del cliente.</small>
      </div>

      <!-- Motivo -->
      <div class="mb-4">
        <label class="form-label fw-semibold text-secondary">Motivo de la devoluciÃ³n</label>
        <textarea 
          class="form-control" 
          [(ngModel)]="model.reason" 
          name="reason" 
          rows="3" 
          placeholder="Describe brevemente el motivo de la devoluciÃ³n..." 
          required
        ></textarea>
      </div>

      <!-- Estado -->
      <div class="mb-4">
        <label class="form-label fw-semibold text-secondary">Estado</label>
        <select class="form-select" [(ngModel)]="model.status" name="status">
          <option value="pending">ğŸ•“ Pendiente</option>
          <option value="reviewing">ğŸ” En revisiÃ³n</option>
          <option value="approved">âœ… Aprobado</option>
          <option value="denied">âŒ Denegado</option>
          <option value="refunded">ğŸ’¸ Reembolsado</option>
        </select>
      </div>

      <!-- Notas internas -->
      <div class="mb-4">
        <label class="form-label fw-semibold text-secondary">Notas internas (solo administrador)</label>
        <textarea 
          class="form-control" 
          [(ngModel)]="model.adminNotes" 
          name="adminNotes" 
          rows="3" 
          placeholder="InformaciÃ³n adicional o seguimiento interno..."
        ></textarea>
      </div>

      <!-- Botones -->
      <div class="d-flex justify-content-end pt-3 border-top">
        <button type="button" class="btn btn-secondary me-2" (click)="cancel()">Cancelar</button>
        <button type="submit" class="btn btn-primary">
          {{ id === 'new' ? 'Crear DevoluciÃ³n' : 'Guardar Cambios' }}
        </button>
      </div>

    </form>
  </div>
</div>
