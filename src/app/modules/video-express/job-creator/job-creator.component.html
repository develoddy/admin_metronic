<div class="row">
  <div class="col-xl-12">
    <!-- Header -->
    <div class="card card-custom gutter-b">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <button class="btn btn-icon btn-light-primary mr-3" (click)="cancel()">
            <i class="flaticon2-left-arrow-1"></i>
          </button>
          <div>
            <h3 class="font-weight-bolder mb-0">üé¨ Crear Nuevo Video</h3>
            <div class="text-muted font-size-sm mt-2">
              Sube una imagen de tu producto y selecciona el estilo de animaci√≥n
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Success Message -->
    <div *ngIf="success" class="alert alert-success fade show" role="alert">
      <div class="alert-icon">
        <i class="flaticon2-check-mark"></i>
      </div>
      <div class="alert-text">
        <strong>¬°Video job creado!</strong> Tu video se est√° generando. Redirigiendo a la lista...
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="alert alert-danger fade show" role="alert">
      <div class="alert-icon">
        <i class="flaticon2-warning"></i>
      </div>
      <div class="alert-text">
        <strong>Error:</strong> {{ error }}
      </div>
    </div>

    <!-- Best Practices Guide -->
    <div class="card card-custom gutter-b">
      <div class="card-header border-0 cursor-pointer" (click)="toggleBestPractices()">
        <div class="card-title">
          <span class="card-icon">
            <i class="flaticon2-rocket-1 text-primary icon-2x"></i>
          </span>
          <h3 class="card-label font-weight-bolder text-dark">
            üí° Mejores Pr√°cticas: ¬øQu√© im√°genes funcionan mejor?
            <span class="text-muted font-weight-normal font-size-sm d-block mt-1">
              Maximiza la calidad de tus videos con estos consejos
            </span>
          </h3>
        </div>
        <div class="card-toolbar">
          <i 
            class="ki ki-arrow-down icon-nm transition-icon"
            [class.rotate-180]="showBestPractices"></i>
        </div>
      </div>
      
      <div class="card-body pt-2" *ngIf="showBestPractices" [@slideDown]>
        <!-- Introduction -->
        <div class="alert alert-custom alert-light-primary mb-5">
          <div class="alert-text font-size-sm">
            <strong>¬øPor qu√© algunos videos se ven mejor?</strong><br>
            Nuestro sistema crea micro-movimientos que dan vida a tus im√°genes. Los mejores resultados se logran con fotos que tienen <strong>texturas, profundidad y elementos visuales din√°micos</strong>.
          </div>
        </div>

        <!-- Examples Grid -->
        <div class="row mb-5">
          <!-- Example 1: Coffee -->
          <div class="col-md-4 mb-4">
            <div class="card card-custom card-border h-100">
              <div class="card-body text-center">
                <span class="label label-lg label-light-success label-inline mb-3">‚úÖ Excelente</span>
                <div class="symbol symbol-100 mx-auto mb-3">
                  <div class="symbol-label bg-light-primary">
                    <i class="flaticon2-coffee text-primary icon-3x"></i>
                  </div>
                </div>
                <h5 class="font-weight-bold mb-2">‚òï Caf√© & Bebidas</h5>
                <p class="text-muted font-size-sm mb-0">
                  Vapor, espuma, brillos l√≠quidos. El movimiento se ve natural y atractivo.
                </p>
              </div>
            </div>
          </div>

          <!-- Example 2: Food -->
          <div class="col-md-4 mb-4">
            <div class="card card-custom card-border h-100">
              <div class="card-body text-center">
                <span class="label label-lg label-light-success label-inline mb-3">‚úÖ Excelente</span>
                <div class="symbol symbol-100 mx-auto mb-3">
                  <div class="symbol-label bg-light-warning">
                    <i class="flaticon2-shopping-cart-1 text-warning icon-3x"></i>
                  </div>
                </div>
                <h5 class="font-weight-bold mb-2">üçî Comida con Textura</h5>
                <p class="text-muted font-size-sm mb-0">
                  Salsas, brillos, queso derretido. Las texturas h√∫medas generan movimiento.
                </p>
              </div>
            </div>
          </div>

          <!-- Example 3: Jewelry -->
          <div class="col-md-4 mb-4">
            <div class="card card-custom card-border h-100">
              <div class="card-body text-center">
                <span class="label label-lg label-light-success label-inline mb-3">‚úÖ Excelente</span>
                <div class="symbol symbol-100 mx-auto mb-3">
                  <div class="symbol-label bg-light-danger">
                    <i class="flaticon2-gift-1 text-danger icon-3x"></i>
                  </div>
                </div>
                <h5 class="font-weight-bold mb-2">üíç Joyas & Relojes</h5>
                <p class="text-muted font-size-sm mb-0">
                  Reflejos met√°licos, brillos. Sensaci√≥n de lujo premium.
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Tips Grid -->
        <div class="row">
          <!-- What Works -->
          <div class="col-lg-6">
            <div class="card card-custom bg-light-success mb-4">
              <div class="card-body">
                <h4 class="text-success font-weight-bolder mb-4">
                  <i class="flaticon2-check-mark mr-2"></i>
                  ‚úÖ Qu√© Funciona Mejor
                </h4>
                <ul class="list-unstyled mb-0">
                  <li class="mb-3">
                    <i class="flaticon2-correct text-success mr-2"></i>
                    <strong>Texturas visibles:</strong> Madera, tela, l√≠quidos, vapor
                  </li>
                  <li class="mb-3">
                    <i class="flaticon2-correct text-success mr-2"></i>
                    <strong>Brillos y reflejos:</strong> Metales, vidrio, superficies h√∫medas
                  </li>
                  <li class="mb-3">
                    <i class="flaticon2-correct text-success mr-2"></i>
                    <strong>Profundidad:</strong> Producto + fondo con contexto
                  </li>
                  <li class="mb-3">
                    <i class="flaticon2-correct text-success mr-2"></i>
                    <strong>Elementos org√°nicos:</strong> Flores, plantas, comida fresca
                  </li>
                  <li class="mb-0">
                    <i class="flaticon2-correct text-success mr-2"></i>
                    <strong>Lighting dram√°tico:</strong> Sombras, contrastes, highlights
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <!-- What Doesn't Work -->
          <div class="col-lg-6">
            <div class="card card-custom bg-light-danger mb-4">
              <div class="card-body">
                <h4 class="text-danger font-weight-bolder mb-4">
                  <i class="flaticon2-cross mr-2"></i>
                  ‚ùå Qu√© Evitar
                </h4>
                <ul class="list-unstyled mb-0">
                  <li class="mb-3">
                    <i class="flaticon2-delete text-danger mr-2"></i>
                    <strong>Fondos 100% planos:</strong> Sin contexto ni profundidad
                  </li>
                  <li class="mb-3">
                    <i class="flaticon2-delete text-danger mr-2"></i>
                    <strong>Productos aislados:</strong> Objeto solo sin ambiente
                  </li>
                  <li class="mb-3">
                    <i class="flaticon2-delete text-danger mr-2"></i>
                    <strong>Im√°genes muy simples:</strong> Sin texturas ni detalles
                  </li>
                  <li class="mb-3">
                    <i class="flaticon2-delete text-danger mr-2"></i>
                    <strong>Colores uniformes:</strong> Sin variaci√≥n tonal
                  </li>
                  <li class="mb-0">
                    <i class="flaticon2-delete text-danger mr-2"></i>
                    <strong>Baja resoluci√≥n:</strong> Fotos pixeladas o borrosas
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- Pro Tips -->
        <div class="alert alert-custom alert-light-warning">
          <div class="alert-icon">
            <i class="flaticon2-warning"></i>
          </div>
          <div class="alert-text">
            <strong>üí° Pro Tip:</strong> El sistema genera <strong>movimientos sutiles</strong> que dan vida a la imagen. No esperes animaciones dram√°ticas, sino micro-movimientos que hacen que el producto parezca "fresco" y "reci√©n servido". Ideal para redes sociales (Instagram Reels, TikTok, X Premium).
          </div>
        </div>
      </div>
    </div>

    <!-- Form -->
    <div class="row">
      <!-- Upload Section -->
      <div class="col-xl-8">
        <div class="card card-custom gutter-b">
          <div class="card-header">
            <div class="card-title">
              <h3 class="card-label">1. Imagen del Producto</h3>
            </div>
          </div>
          <div class="card-body">
            <!-- File Input (Hidden) -->
            <input 
              type="file" 
              #fileInput
              accept="image/jpeg,image/jpg,image/png"
              (change)="onFileSelected($event)"
              style="display: none;">

            <!-- Upload Area -->
            <div 
              *ngIf="!imagePreview"
              class="dropzone dropzone-default dropzone-primary text-center py-10"
              (click)="fileInput.click()">
              <div class="dropzone-msg dz-message needsclick">
                <h3 class="dropzone-msg-title">
                  <i class="flaticon2-photograph icon-4x text-primary mb-5"></i>
                </h3>
                <span class="dropzone-msg-desc">
                  Click para subir o arrastra tu imagen aqu√≠
                </span>
                <div class="text-muted mt-3 font-size-sm">
                  Formatos: JPG, PNG | Tama√±o m√°ximo: 10MB
                </div>
              </div>
            </div>

            <!-- Image Preview -->
            <div *ngIf="imagePreview" class="position-relative">
              <img 
                [src]="imagePreview" 
                alt="Preview" 
                class="img-fluid rounded shadow"
                style="max-height: 400px; width: 100%; object-fit: contain;">
              
              <button 
                class="btn btn-sm btn-danger btn-icon position-absolute"
                style="top: 10px; right: 10px;"
                (click)="clearFile()"
                title="Eliminar imagen">
                <i class="flaticon2-cross"></i>
              </button>

              <!-- File Info -->
              <div class="mt-3 text-muted font-size-sm">
                <i class="flaticon2-file"></i> {{ selectedFile?.name }} ({{ getFileSize() }})
              </div>
            </div>

            <!-- Additional Upload Button -->
            <div *ngIf="imagePreview" class="mt-5">
              <button 
                class="btn btn-light-primary btn-sm"
                (click)="fileInput.click()">
                <i class="flaticon2-photograph"></i>
                Cambiar Imagen
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Style Selection -->
      <div class="col-xl-4">
        <div class="card card-custom gutter-b">
          <div class="card-header">
            <div class="card-title">
              <h3 class="card-label">2. Estilo de Animaci√≥n</h3>
            </div>
          </div>
          <div class="card-body">
            <div *ngFor="let style of animationStyles" class="mb-4">
              <div 
                class="p-3 rounded cursor-pointer border"
                [class.border-primary]="selectedStyle === style.value"
                [class.bg-light-primary]="selectedStyle === style.value"
                (click)="selectStyle(style.value)">
                <div class="d-flex align-items-center">
                  <span 
                    class="symbol symbol-40 symbol-light-primary mr-3"
                    [class.symbol-primary]="selectedStyle === style.value">
                    <span class="symbol-label">
                      <i 
                        class="flaticon2-check-mark text-white"
                        *ngIf="selectedStyle === style.value"></i>
                      <i 
                        class="flaticon2-photograph"
                        *ngIf="selectedStyle !== style.value"></i>
                    </span>
                  </span>
                  <div class="flex-grow-1">
                    <div class="font-weight-bolder mb-1">{{ style.label }}</div>
                    <div class="text-muted font-size-sm">{{ style.description }}</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Info Box -->
            <div class="alert alert-custom alert-light-info mt-5" role="alert">
              <div class="alert-icon">
                <i class="flaticon2-information"></i>
              </div>
              <div class="alert-text font-size-sm">
                <strong>Tiempo estimado:</strong> 1-2 minutos por video
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="card card-custom">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <button 
            class="btn btn-light-danger font-weight-bolder"
            (click)="cancel()"
            [disabled]="loading">
            Cancelar
          </button>
          
          <button 
            class="btn btn-primary font-weight-bolder"
            (click)="onSubmit()"
            [disabled]="!selectedFile || loading">
            <span *ngIf="!loading">
              <i class="flaticon2-rocket"></i>
              Generar Video
            </span>
            <span *ngIf="loading">
              <span class="spinner spinner-white spinner-sm mr-2"></span>
              Procesando...
            </span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
