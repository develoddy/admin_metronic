<div class="row">
  <div class="col-xl-12">
    <!-- Header -->
    <div class="card card-custom gutter-b">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <button class="btn btn-icon btn-light-primary mr-3" (click)="cancel()">
            <i class="flaticon2-left-arrow-1"></i>
          </button>
          <div>
            <h3 class="font-weight-bolder mb-0">游꿟 Crear Nuevo Video</h3>
            <div class="text-muted font-size-sm mt-2">
              Sube una imagen de tu producto y selecciona el estilo de animaci칩n
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Success Message -->
    <div *ngIf="success" class="alert alert-success fade show" role="alert">
      <div class="alert-icon">
        <i class="flaticon2-check-mark"></i>
      </div>
      <div class="alert-text">
        <strong>춰Video job creado!</strong> Tu video se est치 generando. Redirigiendo a la lista...
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="alert alert-danger fade show" role="alert">
      <div class="alert-icon">
        <i class="flaticon2-warning"></i>
      </div>
      <div class="alert-text">
        <strong>Error:</strong> {{ error }}
      </div>
    </div>

    <!-- Form -->
    <div class="row">
      <!-- Upload Section -->
      <div class="col-xl-8">
        <div class="card card-custom gutter-b">
          <div class="card-header">
            <div class="card-title">
              <h3 class="card-label">1. Imagen del Producto</h3>
            </div>
          </div>
          <div class="card-body">
            <!-- File Input (Hidden) -->
            <input 
              type="file" 
              #fileInput
              accept="image/jpeg,image/jpg,image/png"
              (change)="onFileSelected($event)"
              style="display: none;">

            <!-- Upload Area -->
            <div 
              *ngIf="!imagePreview"
              class="dropzone dropzone-default dropzone-primary text-center py-10"
              (click)="fileInput.click()">
              <div class="dropzone-msg dz-message needsclick">
                <h3 class="dropzone-msg-title">
                  <i class="flaticon2-photograph icon-4x text-primary mb-5"></i>
                </h3>
                <span class="dropzone-msg-desc">
                  Click para subir o arrastra tu imagen aqu칤
                </span>
                <div class="text-muted mt-3 font-size-sm">
                  Formatos: JPG, PNG | Tama침o m치ximo: 10MB
                </div>
              </div>
            </div>

            <!-- Image Preview -->
            <div *ngIf="imagePreview" class="position-relative">
              <img 
                [src]="imagePreview" 
                alt="Preview" 
                class="img-fluid rounded shadow"
                style="max-height: 400px; width: 100%; object-fit: contain;">
              
              <button 
                class="btn btn-sm btn-danger btn-icon position-absolute"
                style="top: 10px; right: 10px;"
                (click)="clearFile()"
                title="Eliminar imagen">
                <i class="flaticon2-cross"></i>
              </button>

              <!-- File Info -->
              <div class="mt-3 text-muted font-size-sm">
                <i class="flaticon2-file"></i> {{ selectedFile?.name }} ({{ getFileSize() }})
              </div>
            </div>

            <!-- Additional Upload Button -->
            <div *ngIf="imagePreview" class="mt-5">
              <button 
                class="btn btn-light-primary btn-sm"
                (click)="fileInput.click()">
                <i class="flaticon2-photograph"></i>
                Cambiar Imagen
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Style Selection -->
      <div class="col-xl-4">
        <div class="card card-custom gutter-b">
          <div class="card-header">
            <div class="card-title">
              <h3 class="card-label">2. Estilo de Animaci칩n</h3>
            </div>
          </div>
          <div class="card-body">
            <div *ngFor="let style of animationStyles" class="mb-4">
              <div 
                class="p-3 rounded cursor-pointer border"
                [class.border-primary]="selectedStyle === style.value"
                [class.bg-light-primary]="selectedStyle === style.value"
                (click)="selectStyle(style.value)">
                <div class="d-flex align-items-center">
                  <span 
                    class="symbol symbol-40 symbol-light-primary mr-3"
                    [class.symbol-primary]="selectedStyle === style.value">
                    <span class="symbol-label">
                      <i 
                        class="flaticon2-check-mark text-white"
                        *ngIf="selectedStyle === style.value"></i>
                      <i 
                        class="flaticon2-photograph"
                        *ngIf="selectedStyle !== style.value"></i>
                    </span>
                  </span>
                  <div class="flex-grow-1">
                    <div class="font-weight-bolder mb-1">{{ style.label }}</div>
                    <div class="text-muted font-size-sm">{{ style.description }}</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Info Box -->
            <div class="alert alert-custom alert-light-info mt-5" role="alert">
              <div class="alert-icon">
                <i class="flaticon2-information"></i>
              </div>
              <div class="alert-text font-size-sm">
                <strong>Tiempo estimado:</strong> 1-2 minutos por video
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="card card-custom">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <button 
            class="btn btn-light-danger font-weight-bolder"
            (click)="cancel()"
            [disabled]="loading">
            Cancelar
          </button>
          
          <button 
            class="btn btn-primary font-weight-bolder"
            (click)="onSubmit()"
            [disabled]="!selectedFile || loading">
            <span *ngIf="!loading">
              <i class="flaticon2-rocket"></i>
              Generar Video
            </span>
            <span *ngIf="loading">
              <span class="spinner spinner-white spinner-sm mr-2"></span>
              Procesando...
            </span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
