<!-- ORIGINAL STYLE Y FUNCIONALIDAD -->
<!-- <div class="conv-list">
    <div class="header">
        <h4>Conversaciones</h4>
        <div class="search">
            <input type="text" placeholder="Buscar por user, guest, agente o texto..." [(ngModel)]="searchTerm" (ngModelChange)="onSearchChange()" />
        </div>
    </div>

    <div class="filters">
        <button [class.active]="filterStatus==='pending'" (click)="setFilter('pending')">ðŸ•“ Pendientes</button>
        <button [class.active]="filterStatus==='open'" (click)="setFilter('open')">ðŸ’¬ En curso</button>
        <button [class.active]="filterStatus==='closed'" (click)="setFilter('closed')">âœ… Cerradas</button>
    </div>

    <div *ngIf="filtered.length === 0" class="empty">No hay conversaciones para mostrar.</div>

    <ul>
        <li *ngFor="let c of filtered" class="conv-row">
            <div (click)="select(c)" class="conv-item">
                <div class="left">
                    <div class="title">{{ c.user_id || c.guest_id || c.session_id || ('#' + c.id) }}</div>
                    <div class="preview">{{ c.last_message || (c.messages && c.messages.length ? c.messages[c.messages.length-1].message : '') }}</div>
                </div>
                <div class="right">
                    <div class="time">{{ timeAgo(c.updatedAt || c.createdAt) }}</div>
                    <div *ngIf="c.unread_count && c.unread_count>0" class="badge">{{ c.unread_count }}</div>
                </div>
            </div>
            <div class="actions">
                <button class="btn btn-sm btn-outline-primary" (click)="take(c)">Tomar</button>
            </div>
        </li>
    </ul>
</div> -->
<!-- END ORIGINAL STYLE Y FUNCIONALIDAD -->






<!-- NEW STYLE -->
<!--begin::Sidebar-->
<!-- <div class="flex-column flex-lg-row-auto w-100 w-lg-300px w-xl-400px mb-10 mb-lg-0"> -->
<div class="contacts-container">
  <!--begin::Header con bÃºsqueda-->
  <div class="contacts-header">
    <div class="search-wrapper">
      <i class="fas fa-search search-icon"></i>
      <input
        type="text"
        class="search-input"
        placeholder="Buscar conversaciones..."
        [(ngModel)]="searchTerm"
        (ngModelChange)="onSearchChange()"
        autocomplete="off"
      />
      <span class="results-count" *ngIf="searchTerm">{{ filtered.length }}</span>
    </div>
  </div>
  <!--end::Header-->

  <!--begin::Filters (horizontal clean)-->
  <div class="filters-bar">
    <button 
      class="filter-btn" 
      [class.active]="filterStatus === 'open'" 
      (click)="setFilter('open')">
      <span>Todos</span>
      <span class="count" *ngIf="filterStatus === 'open'">{{ filtered.length }}</span>
    </button>
    <button 
      class="filter-btn" 
      [class.active]="filterStatus === 'pending'" 
      (click)="setFilter('pending')">
      <span>No leÃ­dos</span>
      <span class="count" *ngIf="filterStatus === 'pending'">{{ filtered.length }}</span>
    </button>
    <button 
      class="filter-btn" 
      [class.active]="filterStatus === 'closed'" 
      (click)="setFilter('closed')">
      <span>Cerrados</span>
      <span class="count" *ngIf="filterStatus === 'closed'">{{ filtered.length }}</span>
    </button>
  </div>
  <!--end::Filters-->

  <!--begin::Empty state-->
  <div *ngIf="filtered.length === 0" class="empty-state">
    <i class="fas fa-inbox empty-icon"></i>
    <p class="empty-text">No hay conversaciones</p>
    <p class="empty-hint">Las conversaciones aparecerÃ¡n aquÃ­</p>
  </div>
  <!--end::Empty state-->

  <!--begin::Conversations list-->
  <div class="conversations-list" *ngIf="filtered.length > 0">
    <div
      *ngFor="let c of filtered"
      class="conversation-item"
      [class.selected]="(chat.selectedConversation$ | async)?.id === c.id"
      (click)="select(c)"
    >
      <!--begin::Avatar + Details-->
      <div class="conv-main">
        <div class="avatar">
          <span class="avatar-text">
            {{ getUserName(c)[0].toUpperCase() }}
          </span>
          <span class="status-indicator" *ngIf="c.status === 'open'"></span>
        </div>

        <div class="conv-info">
          <div class="conv-header">
            <span class="conv-name">{{ getUserName(c) }}</span>
            <span class="conv-time">{{ timeAgo(c.updatedAt || c.createdAt) }}</span>
          </div>

          <div class="conv-preview">
            <span class="preview-text">{{ getLastMessage(c) }}</span>
            
            <!--begin::Badges-->
            <div class="conv-badges">
              <span class="badge badge-unread" *ngIf="getUnreadCount(c) > 0">
                {{ getUnreadCount(c) }}
              </span>
              <span class="badge badge-order" *ngIf="c.orderStatus" [attr.data-status]="c.orderStatus">
                <i class="fas fa-box"></i>
              </span>
              <span class="badge badge-return" *ngIf="c.hasReturn">
                <i class="fas fa-undo"></i>
              </span>
            </div>
            <!--end::Badges-->
          </div>

          <!--begin::Order info (si existe)-->
          <div class="order-summary" *ngIf="hasActiveOrder(c)">
            <i class="fas fa-shopping-cart order-icon"></i>
            <span class="order-text">Pedido {{ c.lastOrderNumber }} â€¢ {{ c.lastOrderTotal | currency:'EUR' }}</span>
            <span class="order-status" [attr.data-status]="c.orderPrintfulStatus">{{ c.orderPrintfulStatus || 'pending' }}</span>
          </div>
          <!--end::Order info-->
        </div>
      </div>
      <!--end::Avatar + Details-->
    </div>
  </div>
  <!--end::Conversations list-->
</div>
<!--end::Container-->
